{% extends 'base.html.twig' %}

{% block title %}Mon panier{% endblock %}

{% block body %}
<a href="{{path('app_products')}}">
  <img src="{{asset('assets/img/arrow-small-left.png')}}" alt="fleche">
  continuer mes achats
  </a>
<h1 class="text-center mb-5">Mon panier</h1>
<p class="text-center">Retrouver l'ensemble des produits que vous avez ajouté a votre panier</p>

{% if cart|length > 0 %}
<table class="table mt-4">
  <thead>
    <tr>
      <th scope="col">Produit</th>
       <th scope="col"></th>
      <th scope="col">Quantité</th>
      <th scope="col">Prix</th>
      <th scope="col">Total</th>
       <th scope="col"></th>
    </tr>
  </thead>
  <tbody>
  {% set total = null%}
  {% for product in cart %}
     <tr>
     
      <td>
      <img src="/uploads/{{ product.product.illustration }}" alt="{{ product.product.name }}" height="75px"><br/>
     </td>
        <td> {{product.product.name}}<br>
        <span>{{product.product.subtitle}}</span>
        </td>
        
      <td>
        <a href="{{path('app_decrease', {'id': product.product.id}) }}">
         <img src="{{ asset('assets/img/minus.png') }}" height="12px" alt="Supprimer un produit"> 
         </a>
        x{{product.quantity}}
        <a href="{{path('app_add_to_cart', {'id': product.product.id}) }}">
         <img src="{{ asset('assets/img/add.png') }}" height="12px" alt="ajouter un produit">
         </a>
        </td>
       
      <td>{{(product.product.price /100)|number_format(2, '.', ',')}}€</td>
        <td>{{((product.product.price *  product.quantity) /100)|number_format(2, '.', ',')}}€</td>
        <td> <a href="{{path('app_delete_to_cart', {'id': product.product.id })}}">
        <img src="{{ asset('assets/img/delete.png') }}" height="20px" alt="Supprimer mon produit"> 
        </a>
        </td>
       
    </tr>
   {% set total = total + (product.product.price *  product.quantity) %}
  {% endfor %}
   
  </tbody>
</table>
<div class="text-right mt-3">
<b>Nombre de produits:</b>{{cart|length}}  <br>
<b>Total de mon panier:</b>{{(total /100)|number_format(2, '.', ',')}}€
<a href="" class="btn btn-success btn-block mt-4">Valider mon panier</a>
</div>
{% else %}
<p><b>Votre panier est vide</b></p>
{% endif %}

{% endblock %}
